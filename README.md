# Emotion-Detection-Model
## 資料預處理：(*2grayface.ipynb*) 
載入OpenCV，並使用OpenCV中已經訓練過的人臉辨識模型文件*haarcascade_frontalface_default.xml* 來協助處理圖片  
進行灰階以及裁減到相同大小，最後再重新命名。

###### 原始資料
![image](https://user-images.githubusercontent.com/30427256/110300140-8058fb00-8031-11eb-81b5-cf432af70232.png '原始資料')

###### 處理過後
![image](https://user-images.githubusercontent.com/30427256/110302045-c57e2c80-8033-11eb-8ab8-6b32904473b5.png '處理過後')

處理過後的資料分配到train valid test三個資料夾內，裡面各自再細分成7類情緒

![image](https://user-images.githubusercontent.com/30427256/110303798-c9ab4980-8035-11eb-876d-88270a698050.png)
![image](https://user-images.githubusercontent.com/30427256/110304585-bba9f880-8036-11eb-9081-724c04be7ec2.png)

## 模型訓練：(*emotion_detect.ipynb*)  
建立CNN模型並使用資料進行訓練，測試不同的參數來提高準確度
```
採用的CNN模型
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_7 (Conv2D)            (None, 250, 250, 32)      320       
_________________________________________________________________
activation_13 (Activation)   (None, 250, 250, 32)      0         
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 125, 125, 32)      0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 123, 123, 32)      9248      
_________________________________________________________________
activation_14 (Activation)   (None, 123, 123, 32)      0         
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 61, 61, 32)        0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 59, 59, 64)        18496     
_________________________________________________________________
activation_15 (Activation)   (None, 59, 59, 64)        0         
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 29, 29, 64)        0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 53824)             0         
_________________________________________________________________
dense_7 (Dense)              (None, 128)               6889600   
_________________________________________________________________
activation_16 (Activation)   (None, 128)               0         
_________________________________________________________________
dropout_5 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 64)                8256      
_________________________________________________________________
activation_17 (Activation)   (None, 64)                0         
_________________________________________________________________
dropout_6 (Dropout)          (None, 64)                0         
_________________________________________________________________
dense_9 (Dense)              (None, 7)                 455       
_________________________________________________________________
activation_18 (Activation)   (None, 7)                 0         
=================================================================
Total params: 6,926,375
Trainable params: 6,926,375
Non-trainable params: 0
_________________________________________________________________
```
